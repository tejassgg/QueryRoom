
@{
    ViewBag.Title = "Admin";
}




<div class="row">
    <div class="col-md-2 mt-2 border-right">
        <nav class=" d-none d-md-block bg-primary sidebar mt-2" style="border-radius:5px">

            <div class="sidebar-sticky text-center">
                <ul class="nav flex-column text-dark">
                    <li class="navbar-brand  text-center border-bottom">
                        <span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-bricks" viewBox="0 0 16 16">
                                <path d="M0 .5A.5.5 0 0 1 .5 0h15a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5H14v2h1.5a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5H14v2h1.5a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5H.5a.5.5 0 0 1-.5-.5v-3a.5.5 0 0 1 .5-.5H2v-2H.5a.5.5 0 0 1-.5-.5v-3A.5.5 0 0 1 .5 6H2V4H.5a.5.5 0 0 1-.5-.5v-3zM3 4v2h4.5V4H3zm5.5 0v2H13V4H8.5zM3 10v2h4.5v-2H3zm5.5 0v2H13v-2H8.5zM1 1v2h3.5V1H1zm4.5 0v2h5V1h-5zm6 0v2H15V1h-3.5zM1 7v2h3.5V7H1zm4.5 0v2h5V7h-5zm6 0v2H15V7h-3.5zM1 13v2h3.5v-2H1zm4.5 0v2h5v-2h-5zm6 0v2H15v-2h-3.5z" />
                            </svg>
                            <strong>Admin</strong>
                        </span>
                    </li>
                    <li class="nav-item text-center">


                        @Html.ActionLink("All Questions", "AllQuestions", "QuestionsMVC", null, new { @class = "nav-link text-dark" })

                    </li>


                </ul>
            </div>


        </nav>


        <div class="progress mt-4" style="height: 2px;">
            <div class="progress-bar" role="progressbar" style="width: 33%" aria-valuenow="15" aria-valuemin="0" aria-valuemax="100"></div>
            <div class="progress-bar bg-success" role="progressbar" style="width: 33%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"></div>
            <div class="progress-bar bg-info" role="progressbar" style="width: 33%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
        </div>




        <nav class=" d-none d-md-block bg-primary sidebar mt-4" style="border-radius:5px">
            <div class="sidebar-sticky">
                <ul class="nav flex-column" id="leaderboard">
                    <li class="navbar-brand text-dark text-center border-bottom">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-trophy" viewBox="0 0 16 16">
                            <path d="M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5c0 .538-.012 1.05-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33.076 33.076 0 0 1 2.5.5zm.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935zm10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935zM3.504 1c.007.517.026 1.006.056 1.469.13 2.028.457 3.546.87 4.667C5.294 9.48 6.484 10 7 10a.5.5 0 0 1 .5.5v2.61a1 1 0 0 1-.757.97l-1.426.356a.5.5 0 0 0-.179.085L4.5 15h7l-.638-.479a.501.501 0 0 0-.18-.085l-1.425-.356a1 1 0 0 1-.757-.97V10.5A.5.5 0 0 1 9 10c.516 0 1.706-.52 2.57-2.864.413-1.12.74-2.64.87-4.667.03-.463.049-.952.056-1.469H3.504z" />
                        </svg>
                        <strong>LeaderBoard</strong>
                    </li>
                </ul>
            </div>
        </nav>
    </div>

    <div class="col-md-7 mt-3">
        <div class="row">
            <div class="col-md-4 text-center">
                <button class="btn btn-default btn-sm" onclick="makeChart('pie')">
                    Pie
                </button>
            </div>
            <div class="col-md-4 text-center ">
                <button class="btn btn-default btn-sm" onclick="makeChart('doughnut')">
                    Doughnut
                </button>
            </div>
            <div class="col-md-4 text-center">
                <button class="btn btn-default btn-sm" onclick="makeChart('bar')">
                    Bar
                </button>
            </div>
        </div>
        <canvas class="mt-5" id="myChart"></canvas>

    </div>

    <div class="col-md-3 text-center mt-1">
        <ul class="list-group border-left p-2">
            <li class="list-group-item border-0 bg-primary" style="border-radius:5px; border-bottom-left-radius:0px; border-bottom-right-radius:0px">
                <img src="~/Content/Images/logo.png" height="100px" width="100px" />
            </li>
            <li class="list-group-item border-0 bg-primary">
                <h5 style="font-size: 2em; font-weight:500;">Statistics</h5>
            </li>
            <li class="list-group-item border-0 bg-primary p-1">
                <hr/>
            </li>
            <li class="list-group-item border-0 bg-primary p-1">
                <h5 class="m-0" style="font-size: 1em; font-weight:200;">Total Questions</h5>
                <span class="text-success" id="tqa"></span>
            </li>
            <li class="list-group-item border-0 bg-primary p-1">
                <h5 class="m-0" style="font-size: 1em; font-weight:200;">Total Answers</h5>
                <span class="text-success" id="tap">

                </span>
            </li>
            <li class="list-group-item border-0 bg-primary p-1">
                <h5 class="m-0" style="font-size: 1em; font-weight:200;">Validated Answers</h5>
                <span class="text-success" id="tva">

                </span>
            </li>
            <li class="list-group-item border-0 bg-primary">
                <h5 class="mb-2" style="font-size: 1em; font-weight:200;">Percentage of Questions Answered</h5>
                <div class="progress" style="height: 12px;">
                    <div id="pbar" class="progress-bar bg-success" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </li>
            <li class="list-group-item border-0 bg-primary">
                <h5 class="mb-2" style="font-size: 1em; font-weight:200;">Percentage of Validated Answers</h5>
                <div class="progress" style="height: 12px;">
                    <div id="pbar2" class="progress-bar bg-success" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </li>
            <li class="list-group-item border-0 bg-primary">

            </li>
            <li class="list-group-item border-0 bg-primary">

            </li>
            <li class="list-group-item border-0 bg-primary" style="border-radius:5px; border-top-left-radius:0px; border-top-right-radius:0px">

            </li>


        </ul>

</div>

@section Scripts
{

    <!-- JQuery -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js"></script>

    <script>
        $(document).ready(function () {
            $.ajax({
                type: "GET",
                url: "/fetchnames",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    //alert(JSON.stringify(data));
                    $("#DIV").html('');
                    var DIV = '';
                    $.each(data, function (i, item) {
                        var rows = '<li class="nav-item text-dark text-center my-1">'
                            +
                            item.USERNAME
                            +
                            '&nbsp;&nbsp;&nbsp;'
                            +
                            item.POINTS
                            +
                            '</li>'
                            ;
                        $('#leaderboard').append(rows);
                    }); //End of foreach Loop
                    //console.log(data);
                }, //End of AJAX Success function

                failure: function (data) {
                    alert(data.responseText);
                }, //End of AJAX failure function
                error: function (data) {
                    alert(data.responseText);
                } //End of AJAX error function

            });
        });
        $(document).ready(function () {
            $.ajax({
                type: "GET",
                url: "/adminstats/stats",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    //alert(JSON.stringify(data));
                    $("#DIV").html('');
                    var DIV = '';
                    $("#tqa").append(data.questions);
                    $("#tap").append(data.answers);
                    $("#tva").append(data.validated_answers);
                    $("#pbar").attr("aria-valuenow", data.credibility);
                    $("#pbar").css("width", data.credibility + "%");
                    $("#pbar").append(data.credibility + "%");
                    $("#pbar2").attr("aria-valuenow", data.for_admin);
                    $("#pbar2").css("width", data.for_admin + "%");
                    $("#pbar2").append(data.for_admin + "%");

                    //End of foreach Loop
                    //console.log(data);
                }, //End of AJAX Success function

                failure: function (data) {
                    alert(data.responseText);
                }, //End of AJAX failure function
                error: function (data) {
                    alert(data.responseText);
                } //End of AJAX error function

            });
        });
    </script>

    <script>
        function makeChart(typeofchart) {
            var ad_data;
            $.ajax({
                type: "GET",
                url: "/adminstats/stats",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    //alert(JSON.stringify(data));
                    $("#DIV").html('');
                    var DIV = '';

                    var ctx = document.getElementById("myChart").getContext('2d');
                    var myChart = new Chart(ctx, {
                        type: typeofchart,
                        data: {
                            labels: ["TotalAnswers", "Validated", "Non-Validated"],
                            datasets: [{
                                label: 'Analysis of Answers on Portal',
                                data: [data.answers, data.validated_answers, data.answers - data.validated_answers],
                                backgroundColor: [
                                    'rgba(255, 206, 86, 0.2)',

                                    'rgba(54, 162, 235, 0.2)',
                                    'rgba(255, 99, 132, 0.2)'
                                    ,
                                    'rgba(75, 192, 192, 0.2)',
                                    'rgba(153, 102, 255, 0.2)',
                                    'rgba(255, 159, 64, 0.2)'
                                ],
                                borderColor: [
                                    'rgba(255, 206, 86, 1)',

                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255,99,132,1)',

                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            scales: {
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true
                                    }
                                }]
                            }
                        }
                    });










                    //End of foreach Loop
                    //console.log(data);
                }, //End of AJAX Success function

                failure: function (data) {
                    alert(data.responseText);
                }, //End of AJAX failure function
                error: function (data) {
                    alert(data.responseText);
                } //End of AJAX error function

            });
        }

        $(document).onLoad(makeChart('pie'));


    </script>
}



